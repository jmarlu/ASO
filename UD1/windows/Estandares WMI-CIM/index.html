
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/UD1/windows/Estandares%20WMI-CIM/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Estándares. - Administración de Sistemas Operativos</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%202.75C0%201.784.784%201%201.75%201h12.5c.966%200%201.75.784%201.75%201.75v10.5A1.75%201.75%200%200%201%2014.25%2015H1.75A1.75%201.75%200%200%201%200%2013.25Zm1.75-.25a.25.25%200%200%200-.25.25v10.5c0%20.138.112.25.25.25h12.5a.25.25%200%200%200%20.25-.25V2.75a.25.25%200%200%200-.25-.25ZM7.25%208a.75.75%200%200%201-.22.53l-2.25%202.25a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L5.44%208%203.72%206.28a.749.749%200%200%201%20.326-1.275.75.75%200%200%201%20.734.215l2.25%202.25c.141.14.22.331.22.53m1.5%201.5h3a.75.75%200%200%201%200%201.5h-3a.75.75%200%200%201%200-1.5%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#estandares" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../../.." title="Administración de Sistemas Operativos" class="md-header__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Administración de Sistemas Operativos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Estándares.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Administración de Sistemas Operativos" class="md-nav__button md-logo" aria-label="Administración de Sistemas Operativos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Administración de Sistemas Operativos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UD1-Shell Scripting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            UD1-Shell Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creación de Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Aritmetica/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aritmetica
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Comparadores/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparadores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/IF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Estructura IF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Operadores_Binarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operadores Binarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Argumentos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Argumentos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Case/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Esructura CASE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/While_Until/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Esructura WHILE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/For/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Esructura FOR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Break y Continue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/Actividades/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actividades
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Windows
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Windows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../021_Introducci%C3%B3nPwSh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../comandos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comandos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Manejo%20resultados/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manejo de Resultados
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../022_PowerShell_Sintaxis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sintaxis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../023_PowerShell_ControlFlujo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control de flujo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../024_PowerShell_VectoresFunciones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vectores y funciones
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UD2.Administración procesos y Servicios
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            UD2.Administración procesos y Servicios
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD2/procesosLinux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestión de procesos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD2/GestiServicios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestión de Servicios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD2/programaTareas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programación de Tareas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD2/actuSisOp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actualización del Sistema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD2/registroWindow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Registro de Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UD3.Servicios de Directorio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            UD3.Servicios de Directorio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/teoria/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción a LDAP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/docker-openldap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenLDAP en Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/pam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PAM en Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/LDAP/ServiciosAutenticacion.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Servicios de Autenticación
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/LDAP/IntegracionServiciosLDAP.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integración de Servicios con LDAP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UD3/actividades/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actividades
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="estandares">Estándares.</h1>
<h2 id="que-son-cim-y-wmi">¿Qué son CIM y WMI?</h2>
<p>CIM (Common Information Model) es un estándar abierto creado por la organización DMTF orientado a proveer una definición común para el intercambio de información entre sistemas, redes, aplicaciones y servicios.</p>
<p>WMI (Windows Management Instrumentation) es la implementación de Microsoft de CIM, con la que se proveen métodos para consultar y modificar la configuración de una máquina Window.</p>
<p>Aunque esta definido anteriormente como un estándar abierto, actualmente es el nombre de la implementación . Por lo tanto:</p>
<p>Los cmdlets Wmi fueron los que aparecieron primero pero a partir de Windows PowerShell 3 fueron sustituidos por los CimCmdlets.</p>
<h2 id="descubrir-las-clases-que-soporta">Descubrir las clases que soporta.</h2>
<p><code>Get-CimClass</code> es <strong>EL</strong> comando elegido para descubrir todo lo que se esconde en una infraestructura
CIM/WMI ya que el descubrimiento era hasta ahora el gran punto débil de esta tecnología.</p>
<p>Veamos un ejemplo:</p>
<div class="highlight"><span class="filename">Filtrar clases</span><pre><span></span><code> <span class="nb">Get-CimClass</span> <span class="n">-ClassName</span> <span class="p">*</span><span class="n">network</span><span class="p">*</span>
<span class="p">&gt;&gt;</span>


   <span class="n">NameSpace</span><span class="p">:</span> <span class="n">ROOT</span><span class="p">/</span><span class="n">cimv2</span>

<span class="n">CimClassName</span>                        <span class="n">CimClassMethods</span>      <span class="n">CimClassProperties</span>
<span class="p">------------</span>                        <span class="p">---------------</span>      <span class="p">------------------</span>
<span class="n">Win32_NetworkLoginProfile</span>           <span class="p">{}</span>                   <span class="p">{</span><span class="n">Caption</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">SettingID</span><span class="p">,</span> <span class="n">AccountExpires</span><span class="p">...}</span>
<span class="n">Win32_NetworkAdapterConfiguration</span>   <span class="p">{</span><span class="n">EnableDHCP</span><span class="p">,</span> <span class="n">Rene</span><span class="p">...</span> <span class="p">{</span><span class="n">Caption</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">SettingID</span><span class="p">,</span> <span class="n">ArpAlwaysSourceRoute</span><span class="p">...}</span>
<span class="n">Win32_NetworkAdapterSetting</span>         <span class="p">{}</span>                   <span class="p">{</span><span class="n">Element</span><span class="p">,</span> <span class="n">Setting</span><span class="p">}</span>
</code></pre></div>
<p>Pero podemos, también las propiedades y métodos.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span>  <span class="p">(</span><span class="nb">Get-CimClass</span> <span class="n">-ClassName</span> <span class="n">Win32_NetworkAdapterConfiguration</span><span class="p">).</span>
<span class="p">&gt;&gt;</span> <span class="n">CimClassProperties</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span>
<span class="p">&gt;&gt;</span>

<span class="n">Name</span>
<span class="p">----</span>
<span class="n">Caption</span>
<span class="n">Description</span>
<span class="n">SettingID</span>
</code></pre></div>
<p>También podemos buscar clases que tengan una propiedad o método en concreto.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span>  <span class="nb">Get-CimClass</span> <span class="n">-PropertyName</span> <span class="n">speed</span>


   <span class="n">NameSpace</span><span class="p">:</span> <span class="n">ROOT</span><span class="p">/</span><span class="n">cimv2</span>

<span class="n">CimClassName</span>                        <span class="n">CimClassMethods</span>      <span class="n">CimClassProperties</span>
<span class="p">------------</span>                        <span class="p">---------------</span>      <span class="p">------------------</span>
<span class="n">CIM_NetworkAdapter</span>                  <span class="p">{</span><span class="n">SetPowerState</span><span class="p">,</span> <span class="n">R</span><span class="p">...</span> <span class="p">{</span><span class="n">Caption</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">InstallDate</span><span class="p">,</span> <span class="n">Name</span><span class="p">...}</span>
<span class="n">Win32_NetworkAdapter</span>                <span class="p">{</span><span class="n">SetPowerState</span><span class="p">,</span> <span class="n">R</span><span class="p">...</span> <span class="p">{</span><span class="n">Caption</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">InstallDate</span><span class="p">,</span> <span class="n">Name</span><span class="p">...}</span>
</code></pre></div>
<h2 id="recuperar-las-instancias-de-esas-clases">Recuperar las instancias de esas clases.</h2>
<p>Ya hemos visto que tipos hay. Ahora debemos recuperar el objeto o instancia perteneciente a una clase en concreto.</p>
<p>Veamoslo en el siguiente ejemplo.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">Win32_BIOS</span>


<span class="n">SMBIOSBIOSVersion</span> <span class="p">:</span> <span class="n">VirtualBox</span>
<span class="n">Manufacturer</span>      <span class="p">:</span> <span class="n">innotek</span> <span class="n">GmbH</span>
<span class="n">Name</span>              <span class="p">:</span> <span class="k">Default</span> <span class="n">System</span> <span class="n">BIOS</span>
<span class="n">SerialNumber</span>      <span class="p">:</span> <span class="n">0</span>
<span class="n">Version</span>           <span class="p">:</span> <span class="n">VBOX</span>   <span class="p">-</span> <span class="n">1</span>
</code></pre></div>
<h2 id="recuperar-con-un-filtro-qlcql">Recuperar con un filtro QL/CQL</h2>
<p>Cuando una consulta CIM/WMI devuelve un gran número de objetos, es preferible utilizar (con <code>Where-Object</code>).</p>
<h2 id="comandos-de-la-familia-wmi">Comandos de la familia WMI</h2>
<p>Como hemos dicho anteriormente el conjunto de comandos WMI ha sido sustituido por los comandos de la familia CIM.
Aunque hay muchos scripts que poseen dichos comandos. Por ejemplo, el comando <code>Get-CimInstance</code> tienes como equivalente a <code>get-wmiObject</code></p>
<h2 id="establecer-sesiones-con-equipos-remotos">Establecer sesiones con equipos remotos</h2>
<p>Mientras que los comando WMI se comunicaban con máquinas remotas mediante los protocolos DCOM y RPC. Éstas, no eran óptimas dado que la sesión se elimina después de haber devuelto los resultados.</p>
<p>Sin embargo, los comandos de la familia CIM mejoran enormemente esta comunicación aportando:</p>
<ul>
<li>Una comunicación que permite eligir entre los protocolos HTTPS/WS-Man o DCOM/RPC.</li>
<li>La posibilidad de mantener una sesión entre el cliente y los servidores.</li>
<li>La posibilidad de enviar consultas de manera paralela y no secuencial.</li>
<li>Un mecanismo de «remoting» similar a las sesiones PowerShell remotas.</li>
</ul>
<p>Para el siguiente ejemplo tenemos un Windows server con un dominio y un windows 10 añadido al dominio de tal manera que consultamos desde un ordenador a otro. el nombre de la computadora y el dia que instaló el sistema operativo y su versión.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nv">$s</span> <span class="p">=</span> <span class="nb">New-CimSession</span> <span class="n">-ComputerName</span> <span class="n">localhost</span><span class="p">,</span> <span class="n">cliente2</span>
<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">Win32_operatingSystem</span> <span class="n">-CimSession</span> <span class="nv">$s</span> <span class="p">|</span>
<span class="p">&gt;&gt;</span> <span class="nb">Select-Object</span> <span class="n">PSComputerName</span><span class="p">,</span> <span class="n">Installdate</span><span class="p">,</span> <span class="n">Version</span><span class="p">,</span> <span class="n">Caption</span>

<span class="n">PSComputerName</span> <span class="n">Installdate</span>         <span class="n">Version</span>    <span class="n">Caption</span>
<span class="p">--------------</span> <span class="p">-----------</span>         <span class="p">-------</span>    <span class="p">-------</span>
<span class="n">localhost</span>      <span class="n">06</span><span class="p">/</span><span class="n">10</span><span class="p">/</span><span class="n">2023</span> <span class="n">8</span><span class="p">:</span><span class="n">55</span><span class="p">:</span><span class="n">15</span>  <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">20348</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Server</span> <span class="n">2022</span> <span class="n">Standard</span>
<span class="n">cliente2</span>       <span class="n">15</span><span class="p">/</span><span class="n">03</span><span class="p">/</span><span class="n">2022</span> <span class="n">18</span><span class="p">:</span><span class="n">27</span><span class="p">:</span><span class="n">37</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">19044</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">10</span> <span class="n">Education</span>
</code></pre></div>
<p>Este ejemplo lo he realizado desde el Windows Server dado que tenemos un usuario administrador del dominio. Se puede realizar al contrario, pero tenemos que cambiar la credencial.</p>
<p>Podemos también, quitar todas las conexiones que hemos establecido anteriormente mediante.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Get-CimSession</span>


<span class="n">Id</span>           <span class="p">:</span> <span class="n">1</span>
<span class="n">Name</span>         <span class="p">:</span> <span class="n">CimSession1</span>
<span class="n">InstanceId</span>   <span class="p">:</span> <span class="n">d92a043e-ff09</span><span class="p">-</span><span class="n">4abb</span><span class="p">-</span><span class="n">9fe1-dc53a7678539</span>
<span class="n">ComputerName</span> <span class="p">:</span> <span class="n">cliente2</span>
<span class="n">Protocol</span>     <span class="p">:</span> <span class="n">WSMAN</span>

<span class="n">Id</span>           <span class="p">:</span> <span class="n">2</span>
<span class="n">Name</span>         <span class="p">:</span> <span class="n">CimSession2</span>
<span class="n">InstanceId</span>   <span class="p">:</span> <span class="n">ec1f236f-d97a</span><span class="p">-</span><span class="n">4efb-a18f-ad788b8e7f45</span>
<span class="n">ComputerName</span> <span class="p">:</span> <span class="n">localhost</span>
<span class="n">Protocol</span>     <span class="p">:</span> <span class="n">WSMAN</span>



<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Get-CimSession</span> <span class="p">|</span> <span class="nb">Remove-CimSession</span>
<span class="p">&gt;&gt;</span>
<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Get-CimSession</span>
<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="gestionar-o-monitorizar-eventos">Gestionar o monitorizar eventos.</h2>
<p>Es una herramienta muy útil de CIM/WMI que permite vigilar eventos (click, ejecución de procesos, etc.. ).</p>
<p>Para suscribirnos a un evento, por ejemplo a la creación de proceso.El comando PowerShell clave para llevar a cabo esta
operación es <code>Register-CimIndicationEvent</code>.</p>
<p>Vamos a ver un ejemplo en el que se monitoriza la ejecución cualquier proceso y nos muestra un mensaje.</p>
<div class="highlight"><span class="filename">Script cuando se genera proceso</span><pre><span></span><code><span class="nv">$action</span> <span class="p">=</span> <span class="p">{</span>
  <span class="nv">$name</span> <span class="p">=</span> <span class="nv">$event</span><span class="p">.</span><span class="n">SourceEventArgs</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">ProcessName</span>
  <span class="nv">$id</span> <span class="p">=</span> <span class="nv">$event</span><span class="p">.</span><span class="n">SourceEventArgs</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">ProcessId</span>
  <span class="nb">Write-Host</span> <span class="n">-Object</span> <span class="s2">&quot;New Process Started : Name = $name</span>
<span class="s2"> ID = $id&quot;</span>
<span class="p">}</span>
<span class="nb">Register-CimIndicationEvent</span> <span class="n">-ClassName</span> <span class="s1">&#39;Win32_ProcessStartTrace&#39;</span> <span class="n">-SourceIdentifier</span> <span class="s2">&quot;ProcessSta&quot;</span> <span class="n">-Action</span> <span class="nv">$action</span>
</code></pre></div>
<p>En este ejemplo se suscribe a los eventos generados por la clase denominada Win32_ProcessStartTrace. Esta clase genera un evento cada vez que se inicia un proceso. La variable $action contiene el bloque de script para Action, que usa la $event variable para acceder al evento recibido de CIM.</p>
<h2 id="comunicaciones-remotas-de-windows-powershell">Comunicaciones remotas de Windows PowerShell</h2>
<p>El mecanismo de comunicación remota de Windows PowerShell, presente desde la versión 2.0, llamado también <em>Gestión remota de Windows (WinRM)</em> y nos permite la administración de equipos Windows.</p>
<p>Para autorizar a un sistema a recibir comandos remotos, es necesario activar el remoting con el comando <code>Enable-PSRemoting</code>.
El comando debe ejecutarse en una consola PowerShell abierta con la opción Ejecutar como administrador.</p>
<p>El servicio WinRM se configura básicamente con <strong>HTTP</strong> en el puerto 5985 y escucha en todas las direcciones IP. Para forzar el uso de <strong>HTTPS</strong> y así cifrar sus conexiones, debe primero obtener un certificado que almacenará en el
almacén Equipo local/Personal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La activación y configuración del servicio WinRM en un gran número de servidores o puestos de trabajo puede realizarse con GPO.</p>
</div>
<h3 id="sesiones-remotas">Sesiones Remotas.</h3>
<p>Antes de poder <strong>enviar órdenes</strong> a un equipo remoto para administrarlo, es necesario establecer una sesión remota.
Una sesión remota puede ser:</p>
<ul>
<li><strong>Temporal:</strong> una sesión temporal se establece justo durante el tiempo del envío de un comando con <code>Invoke-Command o Enter-PSSession</code>.</li>
<li><strong>Permanente:</strong> Una sesión permanente es útil en los casos donde debemos ejecutar varios comandos que comparten datos mediante variables o funciones. La creación de una conexión permanente a un equipo local o remoto se realiza con el comando
  <code>New-PSSession</code></li>
</ul>
<div class="highlight"><span class="filename">Establecientod una sesion con Cliente2</span><pre><span></span><code><span class="nv">$session</span> <span class="p">=</span> <span class="nb">New-PSSession</span> <span class="n">-ComputerName</span> <span class="n">cliente2</span>
<span class="c"># Si necesitamos cambiar de credenciales podemos utilizar el siguiente comandos</span>

<span class="nv">$cred</span> <span class="p">=</span> <span class="nb">Get-Credential</span>
<span class="nv">$session</span> <span class="p">=</span> <span class="nb">New-PSSession</span> <span class="n">-ComputerName</span> <span class="n">cliente2</span>  <span class="n">-Credential</span> <span class="nv">$cred</span>
</code></pre></div>
<p>Ahora podemos ejecutar de comandos remotos con <code>Invoke-Command</code></p>
<div class="highlight"><span class="filename">consulta de servicios en ejecución de Cliente2</span><pre><span></span><code><span class="nv">$cmde</span> <span class="p">=</span> <span class="p">{</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Where </span><span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="err">’</span><span class="n">running</span><span class="err">’</span><span class="p">}</span> <span class="p">}</span>
<span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">cliente2</span> <span class="n">-ScriptBlock</span> <span class="nv">$cmde</span>
<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>                            <span class="n">PSComputerName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>                            <span class="p">--------------</span>
<span class="n">Running</span>  <span class="n">AdobeARMservice</span>    <span class="n">Adobe</span> <span class="n">Acrobat</span> <span class="n">Update</span> <span class="n">Service</span>           <span class="n">cliente2</span>
<span class="n">Running</span>  <span class="n">Appinfo</span>            <span class="n">Información</span> <span class="n">de</span> <span class="n">la</span> <span class="n">aplicación</span>           <span class="n">cliente2</span>
<span class="n">Running</span>  <span class="n">AppXSvc</span>            <span class="n">Servicio</span> <span class="n">de</span> <span class="n">implementación</span> <span class="n">de</span> <span class="n">AppX</span> <span class="p">...</span> <span class="n">cliente2</span>
</code></pre></div>
<p>En el siguiente ejemplo lanzamos un comando en la máquina cliente2 utilizando la sesión anteriormente creada $sesion.</p>
<div class="highlight"><pre><span></span><code> <span class="nb">Invoke-Command</span> <span class="n">-Session</span> <span class="nv">$session</span> <span class="n">-ScriptBlock</span> <span class="p">{</span><span class="nv">$s</span><span class="p">=</span><span class="nb">Get-Service</span> <span class="n">wuauserv</span><span class="p">}</span>



<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span>  <span class="nb">Invoke-Command</span> <span class="n">-Session</span> <span class="nv">$session</span> <span class="n">-ScriptBlock</span> <span class="p">{</span><span class="nv">$s</span><span class="p">}</span>



<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>                            <span class="n">PSComputerName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>                            <span class="p">--------------</span>
<span class="n">Running</span>  <span class="n">wuauserv</span>           <span class="n">Windows</span> <span class="n">Update</span>                         <span class="n">cliente2</span>

<span class="nb">Invoke-Command</span> <span class="n">-Session</span> <span class="nv">$session</span> <span class="n">-ScriptBlock</span> <span class="p">{</span><span class="nv">$s</span> <span class="p">|</span> <span class="nb">Stop-Service</span><span class="p">}</span>



<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span>  <span class="nb">Invoke-Command</span> <span class="n">-Session</span> <span class="nv">$session</span> <span class="n">-ScriptBlock</span> <span class="p">{</span><span class="nv">$s</span><span class="p">}</span>



<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>                            <span class="n">PSComputerName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>                            <span class="p">--------------</span>
<span class="n">Stopped</span>  <span class="n">wuauserv</span>           <span class="n">Windows</span> <span class="n">Update</span>                         <span class="n">cliente2</span>
</code></pre></div>
<p>En el siguiente ejemplo vamos a la ver cuanto disco duro queda libre en el equipo remoto , pero esta vez ejecutamos un script en el equipo remoto.
Empecemos por el script.</p>
<div class="highlight"><span class="filename">Script freeSpace.ps1</span><pre><span></span><code><span class="k">Function</span> <span class="nb">Get-DiskFreeSpace</span> <span class="p">{</span>
<span class="nv">$Disks</span> <span class="p">=</span> <span class="n">Get</span><span class="p">-</span> <span class="n">Win32_LogicalDisk</span> <span class="p">|</span>
<span class="nb">Where </span><span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">DriveType</span> <span class="o">-eq</span> <span class="n">3</span><span class="p">}</span>
<span class="k">Foreach</span><span class="p">(</span><span class="nv">$disk</span> <span class="k">in</span> <span class="nv">$Disks</span><span class="p">)</span>
<span class="p">{</span>
<span class="nv">$prop</span> <span class="p">=</span> <span class="no">[Ordered]</span><span class="p">@{</span>
<span class="err">’</span><span class="n">ID</span><span class="err">’</span> <span class="p">=</span> <span class="nv">$disk</span><span class="p">.</span><span class="n">DeviceID</span>
<span class="err">’</span><span class="n">FreeSpace</span><span class="p">(</span><span class="n">GB</span><span class="p">)</span><span class="err">’</span> <span class="p">=</span> <span class="no">[Math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$disk</span><span class="p">.</span><span class="n">FreeSpace</span><span class="p">)/</span><span class="n">1GB</span><span class="p">,</span><span class="n">3</span><span class="p">)</span>
<span class="err">’</span><span class="n">FreeSpace</span><span class="p">(%)</span><span class="err">’</span> <span class="p">=</span>
<span class="no">[Math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$disk</span><span class="p">.</span><span class="n">FreeSpace</span><span class="p">)*</span><span class="n">100</span><span class="p">/(</span><span class="nv">$disk</span><span class="p">.</span><span class="n">Size</span><span class="p">),</span><span class="n">3</span><span class="p">)</span>
<span class="p">}</span>
<span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$prop</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Vamos a explicar el anterior script un poco más:</p>
<ul>
<li>Hemos creado una función que podemos reutilizar.</li>
<li>Se crea una variable <code>$disk</code> para contener la consulta sobre los discos que sean de tipo 3. Estos son discos locales.</li>
<li>Se crea un objeto personalizado <code>New-Object</code> por cada uno de los discos en las que las propiedades de estos viene determinada por una matriz diccionario ordenada <code>[Ordered]@</code>.</li>
</ul>
<p>A continuación se ejecuta ese script en los ordenadores remotos, en este caso cliente2.</p>
<div class="highlight"><span class="filename">Invocamos</span><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">cliente2</span> <span class="n">-FilePath</span> <span class="p">.\</span><span class="n">Documents</span><span class="p">\</span><span class="n">free</span><span class="p">.</span><span class="n">ps1</span>


<span class="n">DeviceID</span> <span class="n">DriveType</span> <span class="n">ProviderName</span> <span class="n">VolumeName</span> <span class="n">Size</span>        <span class="n">FreeSpace</span> <span class="n">PSComputerName</span>
<span class="p">--------</span> <span class="p">---------</span> <span class="p">------------</span> <span class="p">----------</span> <span class="p">----</span>        <span class="p">---------</span> <span class="p">--------------</span>
<span class="n">C</span><span class="p">:</span>       <span class="n">3</span>                                 <span class="n">53083406336</span> <span class="n">765591552</span> <span class="n">cliente2</span>

<span class="n">ID</span>             <span class="p">:</span> <span class="n">C</span><span class="p">:</span>
<span class="n">FreeSpace</span><span class="p">(</span><span class="n">GB</span><span class="p">)</span>  <span class="p">:</span> <span class="n">0</span><span class="p">,</span><span class="n">713</span>
<span class="n">FreeSpace</span><span class="p">(%)</span>   <span class="p">:</span> <span class="n">1</span><span class="p">,</span><span class="n">442</span>
<span class="n">PSComputerName</span> <span class="p">:</span> <span class="n">cliente2</span>
<span class="n">RunspaceId</span>     <span class="p">:</span> <span class="n">1f37c8a5</span><span class="p">-</span><span class="n">986b</span><span class="p">-</span><span class="n">4766-ba65-c85143e3d03f</span>
</code></pre></div>
<p>En el anterior ejemplo no hemos abierto una sesión , hemos utilizado la opción <code>-ComputerName</code></p>
<h4 id="apertura-de-una-sesion-remota-interactiva-powershell">Apertura de una sesión remota interactiva PowerShell</h4>
<p>Se puede ejecutar comandos en modo interactivo en un equipo remoto. Se trata de un funcionamiento similar al de SSH.</p>
<p>El comando <code>Enter-PSSession</code> arranca una única sesión interactiva en un equipo remoto. Se puede abrir una sola sesión interactiva a la vez.
Ejemplo:</p>
<div class="highlight"><span class="filename">Sesion remota interactiva</span><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">.</span><span class="n">WIN-OT4FJF7Q1AT</span><span class="p">&gt;</span> <span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">cliente2</span>
<span class="no">[cliente2]</span><span class="p">:</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrador</span><span class="p">\</span><span class="n">Documents</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="importacion-de-comandos">Importación de comandos</h4>
<p>Supongamos que en un equipo tenemos modulos que nos gustaría usar en nuestro equipo local.</p>
<p>Veamos un ejemplo, en nuestro disponemos de un servidor con el
rol «Active Directory Domain Services» instalado. Este módulo aporta numerosos comandos para la gestión de objetos de usuario, equipos, grupos, OUs, etc. Por lo tanto queremos importar este módulo en la sesión actual de nuestro cliente.</p>
<p>Creamos una sesión e importamos el módulo desde el servidor al <code>cliente2</code>. <strong>La sesión que tenemos que abrir en el cliente es de administrador, sino no nos deja</strong>.</p>
<div class="highlight"><span class="filename">Importación de módulo</span><pre><span></span><code><span class="nb">PS </span><span class="p">&gt;</span> <span class="nv">$s</span> <span class="p">=</span> <span class="nb">New-PSSession</span> <span class="n">-ComputerName</span> <span class="n">servidor</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Invoke-Command</span> <span class="n">-Session</span> <span class="nv">$s</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">Import-Module</span> <span class="n">ActiveDirectory</span> <span class="p">}</span>
<span class="c"># ya hemos importado (esto se toma un poco de tiempo) desde server y ahora podemos importar los comandos que lo componen.</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Import-PSSession</span> <span class="n">-Session</span> <span class="nv">$s</span> <span class="n">-Module</span> <span class="n">ActiveDirectory</span>
</code></pre></div>
<p>Con lo cuál, ahora ya podemos utilizar esos comandos.</p>
<div class="highlight"><span class="filename">Demostración</span><pre><span></span><code><span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Get-Command</span> <span class="p">*</span><span class="n">-AD</span><span class="p">*</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.top", "navigation.path", "navigation.footer", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>